<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Moul&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Battambang&family=Moul&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css" integrity="sha512-Evv84Mr4kqVGRNSgIGL/F/aIDqQb7xQ2vcrdIwxfjThSH8CSR7PBEakCr51Ck+w+/U6swU2Im1vVX0SVk9ABhg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
  <title>ព័ត៌មានសិស្សទី៩</title>
  
  <style>
    body {
     font-family: "Segoe UI", sans-serif,  "Moul";
      background-color: rgb(216, 236, 253);
      margin: 0;
      padding: 10px;
      font-weight: 400;
      font-style: normal;
      
    }
    form {
       background: rgba(255, 255, 255, 0.15);
      backdrop-filter: blur(15px);
      -webkit-backdrop-filter: blur(15px);
      padding: 20px;
      max-width: 800px;
      margin: 0px auto;
      border-radius: 8px;
      box-shadow: 0 0 10px #ccc;
     
    }

     .form-header {
      display: flex;
      align-items: center;
      gap: 15px;
      margin-bottom: 2rem;
       
    }
     .form-header h2 {
     font-size: 0.96rem;
    }
    
    .logo {
      height: 50px;
    }
    .form-header {
      text-align: left;
      margin-bottom: 20px;
    }
    .form-row {
      display: flex;
      gap: 15px;
      margin-bottom: 15px;
      flex-wrap: wrap;
    }
    .triple > label {
      flex: 1 1 30%;
    }
    label {
      flex: 1;
      display: flex;
      flex-direction: column;
      font-weight: normal;
    }
    input, select {
      padding: 8px;
      margin-top: 5px;
      border: 1px solid #aaa;
      border-radius: 5px;
       font-family: "Battambang", system-ui;
        font-size: 1rem;
    }
    .options {
      display: flex;
      gap: 15px;
      margin-top: 5px;
    }
    .square-radio input[type="radio"] {
      appearance: none;
      width: 18px;
      height: 18px;
      border: 2px solid #555;
      margin-right: 5px;
      display: inline-block;
      vertical-align: middle;
      border-radius: 3px;
      position: relative;
    }
    .square-radio input[type="radio"]:checked::after {
      content: "✅";
      position: absolute;
      top: -8px;
      left: -4px;
      color: green;
      font-size: 18px;
      font-style: bold;
    }
      .form-buttons {
      display: flex;
      gap: 20px;
      flex-wrap: wrap;
      justify-content: center;
    }

    button {
      flex: 1;
      min-width: 120px;
      padding: 10px 20px;
      font-size: 1rem;
      border: none;
      border-radius: 10px;
      
      color: rgb(231, 230, 230);
      cursor: pointer;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
      transition: transform 0.2s ease;
       font-family: "Battambang", system-ui;
    }

     

    button:hover {
      transform: translateY(-2px);
    }
    #status {
      margin-top: 15px;
      text-align: center;
      font-weight: normal;
      color: green;
    }
    @media (max-width: 600px) {
      .form-buttons {
        flex-direction: row;
      }
    }
     .custom-file-input {
    display: none;
  }

  .custom-file-label {
    display: inline-block;
    padding: 8px 15px;
    background-color: #007bff;
    color: rgb(223, 223, 223);
    border-radius: 5px;
    cursor: pointer;
    font-family: "Battambang", system-ui;
    height: 30px;
  }
 .custom-file-label:hover {
      transform: translateY(-2px);
    }

  .filename-display {
    margin-left: 10px;
    font-family: "Battambang", system-ui;
    font-size: 0.95rem;
  }
  .btn3d {
	position: relative;
	top: -6px;
	border: 0;
	transition: all 40ms linear;
	margin-top: 10px;
	margin-bottom: 10px;
	margin-left: 2px;
	margin-right: 2px;
}

.btn3d:active:focus,
.btn3d:focus:hover,
.btn3d:focus {
	-moz-outline-style: none;
	outline: medium none;
}

.btn3d:active,
.btn3d.active {
	top: 2px;
}
.btn3d.btn-success {
	box-shadow: 0 0 0 1px #31c300 inset, 0 0 0 2px rgba(255, 255, 255, 0.15) inset, 0 8px 0 0 #5eb924, 0 8px 8px 1px rgba(0, 0, 0, 0.5);
	background-color: #42a302;
}

.btn3d.btn-success:active,
.btn3d.btn-success.active {
	box-shadow: 0 0 0 1px #30cd00 inset, 0 0 0 1px rgba(255, 255, 255, 0.15) inset, 0 1px 3px 1px rgba(0, 0, 0, 0.3);
	background-color: #42a302;
}

.btn3d.btn-default {
	color: #666666;
	box-shadow: 0 0 0 1px #ebebeb inset, 0 0 0 2px rgba(255, 255, 255, 0.10) inset, 0 8px 0 0 #BEBEBE, 0 8px 8px 1px rgba(0, 0, 0, .2);
		background-color: #bab8b8;
}

.btn3d.btn-default:active,
.btn3d.btn-default.active {
	color: #ffffff;
	box-shadow: 0 0 0 1px #ebebeb inset, 0 0 0 1px rgba(255, 255, 255, 0.15) inset, 0 1px 3px 1px rgba(0, 0, 0, .1);
	background-color: #bab8b8;
}


  </style>
</head>
<body>
  <form id="signupForm">
    <div class="form-header">
      <img src="moeys.png" alt="Logo" class="logo">
     <h2 class="sitename">ព័ត៌មានសិស្ស<span class="auto-input ti"></span></h2>
    </div>
    <div class="form-row">
      <label>ឈ្មោះសិស្ស<input type="text" name="name"  placeholder="នាមត្រកូល នាមខ្លួន" required></label>
      <label>
        <div class="options" id="sex">ភេទ
          <label class="square-radio" >ប្រុស<input type="radio" name="sex" value="ប្រុស"   required></label>
          <label class="square-radio"  >ស្រី<input type="radio" name="sex" value="ស្រី" ></label>
        </div>
      </label>
    </div>
    <div class="form-row">
      <label>ថ្ងៃខែឆ្នាំកំណើត<input type="text" name="dob" placeholder="ថ្ងៃ / ខែ / ឆ្នាំ" required></label>
      <label>ទីកន្លែងកំណើត<input type="text" name="pob" placeholder="ខេត្ត ឬ ក្រុង" required></label>
    </div>
    <div class="form-row">
      <label>រៀនថ្នាក់ទី
        <select name="grade">
           <option value="" required>ជ្រើសរើស</option>
        <option>9A</option>
        <option>9B</option>
        <option>9C</option>
        <option>9D</option>
        <option>9E</option>
        <option>9F</option>
        <option>9G</option>
		<option>9H</option>
        </select>
      </label>
      <label>
        <div class="options">ភាសា
          <label class="square-radio">អង់គ្លេស<input type="radio" name="language" value="អង់គ្លេស" required></label>
          <label class="square-radio">បារាំង<input type="radio" name="language" value="បារាំង"></label>
        </div>
      </label>
    </div>
    <!-- 
   <div class="form-row triple">
     <label>សម័យប្រឡងបឋមភូមិ<input type="text" name="date_exam" placeholder="ថ្ងៃ / ខែ / ឆ្នាំ" required></label>
      <label>លេខបន្ទប់<input type="number" name="room_no" required></label>
      <label>លេខតុ<input type="number" name="table_no" required></label>
     -->
    <div class="form-row">
      <label>ឈ្មោះឪពុក<input type="text" name="father_name" required></label>
      <label>មុខរបរឪពុក<input type="text" name="father_job" required></label>
    </div>
    <div class="form-row">
      <label>ឈ្មោះម្ដាយ<input type="text" name="mother_name" required></label>
      <label>មុខរបរម្ដាយ<input type="text" name="mother_job" required></label>
    </div>
    <div class="form-row">
      <label>លេខទូរសព្ទផ្ទាល់ខ្លួន<input type="tel" name="phone" required></label>
     <div> <label>រូបថតសំបុត្រកំណើត</label>
      <label class="custom-file-label">
  ជ្រើសរូបភាព <i class="fa-regular fa-image"></i>
  <input type="file" name="image" class="custom-file-input" accept=".jpg,.jpeg,.png" required onchange="showFileName(this)">
</label>
<span class="filename-display" id="file-name" style="color:red">មិនទាន់ជ្រើសរូបភាព</span>
</div>
    </div>
    <div class="form-buttons">
        <button type="reset" class="btn3d btn btn-default btn-lg">សម្អាត <i class="fa-solid fa-arrows-rotate"></i></button>
      <button type="submit" class="btn btn-success btn-lg btn3d">រក្សាទុក <i class="fa-solid fa-floppy-disk"></i></button>
    
      
    </div>
   <p id="status" ></p> 
  </form>

<script>
document.getElementById("signupForm").addEventListener("submit", async function (e) {
  e.preventDefault();

  const form = e.target;
  const status = document.getElementById("status");
  const submitBtn = form.querySelector('button[type="submit"]');

  // Disable button during submission
  submitBtn.disabled = true;
  submitBtn.style.opacity = "0.6";
  submitBtn.style.cursor = "not-allowed";
  status.textContent = "⏳ កំពុងរក្សាទុក...";

  const formData = new FormData(form);
  const imageInput = document.querySelector('input[name="image"]');
  const imageFile = imageInput.files && imageInput.files[0];

  if (!imageFile || imageFile.size === 0 || !imageFile.type.match(/^image\/(jpeg|png)$/)) {
    status.textContent = "❌ សូមជ្រើសរូបភាព (.jpg, .png)";
    submitBtn.disabled = false;
    submitBtn.style.opacity = "1";
    submitBtn.style.cursor = "pointer";
    return;
  }

  const reader = new FileReader();
  reader.onload = async function () {
    const imageBase64 = reader.result;

    const data = new URLSearchParams();
    formData.forEach((value, key) => {
      if (key !== "image") data.append(key, value);
    });
    data.append("image", imageBase64);
    data.append("imageType", imageFile.type);

    try {
      const response = await fetch("https://script.google.com/macros/s/AKfycbym_HaWSh44TB2M96uGMhxhrBG46Y72h77qsz99ifRwB0X_wBNaPP9YticJoF7cNiUgcg/exec", {
        method: "POST",
        body: data,
      });

      const result = await response.text();
      if (response.ok && result.includes("Success")) {
        status.textContent = "✅ រក្សាទុករួចរាល់!";
        form.reset();
      } else {
        status.textContent = "❌ បញ្ហាក្នុងការផ្ញើទិន្នន័យ: " + result;
      }
    } catch (err) {
      status.textContent = "❌ បញ្ហា: " + err.message;
    } finally {
      // Re-enable button after sending data
      submitBtn.disabled = false;
      submitBtn.style.opacity = "1";
      submitBtn.style.cursor = "pointer";
    }
  };

  reader.readAsDataURL(imageFile);
});

document.getElementById("signupForm").addEventListener("reset", function () {
  document.getElementById("file-name").textContent = "មិនទាន់ជ្រើសរូបភាព";
  document.getElementById("file-name").style.color = "red";
});

function showFileName(input) {
  const fileNameSpan = document.getElementById("file-name");
  if (input.files && input.files[0]) {
    fileNameSpan.textContent = "បានជ្រើសរូបភាពហើយ ✅";
    fileNameSpan.style.color = "green";
  } else {
    fileNameSpan.textContent = "មិនទាន់ជ្រើសរូបភាព";
    fileNameSpan.style.color = "red";
  }
}
</script>


  <!-- sitename-->
  <script src="https://cdn.jsdelivr.net/npm/typed.js@2.0.12"></script>
  <script>
      var tyed = new Typed(".auto-input",{
      strings: [" នៃវិទ្យាល័យហ៊ុនសែនមិត្តភាព", "សម្រាប់ការប្រឡងសញ្ញាបត្រមធ្យមសិក្សាបឋមភូមិ"],
      typeSpeed: 150,
      
      loop: true
  })
  </script>
</body>
</html>

